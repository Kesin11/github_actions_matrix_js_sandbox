name: "Docker in Docker"
on: [push]

jobs:
  docker_build:
    runs-on: ubuntu-latest
    container:
      image: docker
    steps:
    - uses: actions/checkout@v1

    - run: whoami
    - run: uname -a
    - run: env

    # build image using "docker in docker"
    - run: docker build -t self_build .

  docker_run_self:
    needs: docker_build
    runs-on: ubuntu-latest
    container:
      image: docker
      # if you enable github package registory beta program, it may be use for docker push and pull
      # image: docker.pkg.github.com/Kesin11/docker.github_actions_matrix_js_sandbox/github_actions_matrix_js_sandbox:latest

    steps:
      # self built image can use
      - run: docker run self_build
